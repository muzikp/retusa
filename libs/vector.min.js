"use strict";var $=require("./locale").call,{filters:filters,validators:validators}=require("./parsers"),schemas=require("./schemas");const{Array:Array,Math:Math,String:String,Function:Function}=require("./extensions"),{VectorMarkdown:VectorMarkdown,VectorOverview:VectorOverview}=require("./markdown");var{VectorValueError:VectorValueError,ArgumentError:ArgumentError,Empty:Empty}=require("./errors");const registry=new WeakMap,enums={_numeric:1,_string:2,_boolean:3,_multiple:4,_date:5};function setRegistryProperty(e,r,t){var i=getRegistryProperty(e);i[r]=t,registry.set(e,i)}function getRegistryProperty(e,r=null){return r?registry.get(e)[r]:registry.get(e)}class Vector extends Array{constructor(){super(),[...arguments].length>0&&this.push(...arguments),registry.set(this,{})}type(e){return e?this.constructor.name:enums[`_${this.constructor.name.replace("Vector","").toLocaleLowerCase()}`]}push(){for(let e of[...arguments].flat(1/0))this.parse?super.push(this.parse(e)):super.push(e)}name(e){return e?(setRegistryProperty(this,"name",e),this):registry.get(this).name}parent(e){return e?(setRegistryProperty(this,"parent",e),this):registry.get(this).parent}serialize(){return{values:this,name:this.name()}}clone(e=!1){return e?new this.constructor(...this):new this.constructor}ifilter(e=(()=>!0)){return new Array(...this._values).map((function(r,t){return e(r)?t:-1})).filter((e=>e>-1))}}Vector.prototype.isVector=!0;const vectorParser={numeric:function(e){if(0===e||"0"===e)return 0;if(e){if(isNaN(e))throw new VectorValueError($("UyOj",{value:e}),{vector:this,value:e});return Number(e)}return null},string:function(e){return e||!1===e||0===e?String(e):null},boolean:function(e){return!!e||!1!==e&&0!==e&&null}};class NumericVector extends Vector{constructor(){super(...arguments)}}NumericVector.prototype.parse=vectorParser.numeric;class StringVector extends Vector{constructor(){super(...arguments)}}StringVector.prototype.parse=vectorParser.string;class BooleanVector extends Vector{constructor(){super(...arguments)}}BooleanVector.prototype.parse=vectorParser.boolean,Array.prototype.numerify=function(){return new NumericVector(...this)},Array.prototype.stringify=function(){return new StringVector(...this)},Array.prototype.boolify=function(){return new BooleanVector(...this)},Array.prototype.vectorify=function(){if(!this.find((e=>!0!==e&&!1!==e&&null!==e)))return new BooleanVector(...this);try{return new NumericVector(...this)}catch(e){return new StringVector(...this)}};const VectorMethodsModels=[{name:"sum",fn:Array.prototype.sum,filter:filters.number,wiki:{title:"gvdg",description:"iMbD"},type:[1],returns:schemas.number,example:function(){new NumericVector(200,250,150,320,240,-250,10,-320).sum()}},{name:"count",fn:Array.prototype.count,wiki:{title:"tdrm",description:"ULJX"},type:[1,2,3],returns:schemas.uint,example:function(){new NumericVector(200,250,null,150,320,240,-250,null,10,-320).count(),new StringVector("A","B","C","D").count(),new BooleanVector(!0,!0,!1,null,!1,!0).count()}},{name:"avg",fn:Array.prototype.avg,filter:filters.number,wiki:{title:"eFdj",description:"UYJN"},type:[1],returns:schemas.number,example:function(){new NumericVector(200,250,150,320,240,-250,10,-320).sum()}},{name:"stdev",fn:Array.prototype.stdev,filter:filters.number,wiki:{title:"oUcc",description:"ZgSc"},type:[1],returns:schemas.number,example:function(){new NumericVector(10,20,15,25,23,19,18,17,24,23).stdev(),new NumericVector(10,20,15,25,23,19,18,17,24,23).stdev(!0)},args:{s:{wiki:{title:"eJTq",description:"FfpU"},required:!1,default:!1,type:"boolean",validator:validators.boolean}}},{name:"variance",fn:Array.prototype.variance,filter:filters.number,wiki:{title:"TvQv",description:"sfCh"},type:[1],returns:schemas.number,example:function(){new NumericVector(10,20,15,25,23,19,18,17,24,23).variance(),new NumericVector(10,20,15,25,23,19,18,17,24,23).variance(!0)},args:{s:{wiki:{title:"eJTq",description:"FfpU"},required:!1,default:!1,type:"boolean",validator:validators.boolean}}},{name:"histogram",fn:Array.prototype.histogram,filter:filters.number,wiki:{title:"PAwR",description:"AISp"},type:[1],returns:schemas.histogram,example:function(){var e=new NumericVector(4.5,3.9,5,6,7,5.7,9.1,5.3,7.2,6.9,6,7.5,5.3,7.1,8.2,1);e.histogram(),e.histogram(4),e.histogram(null,2)},args:{maxIntervals:{wiki:{title:"WnZK",description:"FfpU"},required:!1,default:null,type:"number",validator:validators.positiveInteger},fixedInterval:{wiki:{title:"Mnfn",description:"yOuB"},required:!1,default:null,type:"number",validator:validators.positiveDecimal}}},{name:"min",fn:Array.prototype.min,filter:filters.notnull,wiki:{title:"FkaD",description:"yBlA"},type:[1,2],example:function(){new NumericVector(4.5,3.9,5,6,7,5.7,9.1,5.3,7.2,6.9,6,7.5,5.3,7.1,8.2,1).min(),new StringVector("Norwood","Pearson","Fisher","Nightingale","Gauss","Poisson").min()},returns:[schemas.number,schemas.string]},{name:"max",fn:Array.prototype.max,filter:filters.notnull,wiki:{title:"nKuF",description:"gkep"},type:[1,2],returns:[schemas.number,schemas.string],example:function(){new NumericVector(4.5,3.9,5,6,7,5.7,9.1,5.3,7.2,6.9,6,7.5,5.3,7.1,8.2,1).max(),new StringVector("Norwood","Pearson","Fisher","Nightingale","Gauss","Poisson").max()}},{name:"range",fn:Array.prototype.range,filter:filters.number,wiki:{title:"mXxJ",description:"dnzB"},type:[1],returns:schemas.number,example:function(){new NumericVector(5,2,-15,-16.3,12,null,null,12,13,7).range()}},{name:"varc",fn:Array.prototype.varc,filter:filters.number,wiki:{title:"uwpU",description:"fUpj"},type:[1],returns:schemas.number,example:function(){new NumericVector(10,20,15,25,23,19,18,17,24,23).varc(),new NumericVector(10,20,15,25,23,19,18,17,24,23).varc(!0)},args:{s:{wiki:{title:"eJTq",description:"FfpU"},required:!1,default:!1,type:"boolean",validator:validators.boolean}}},{name:"percentile",fn:Array.prototype.percentile,filter:filters.number,wiki:{title:"fPra",description:"yNbM"},type:[1],returns:schemas.number,example:function(){var e=new NumericVector(10,20,15,25,23,19,18,17,24,23);e.percentile(.5),e.percentile(.25),e.percentile(1)},args:{k:{wiki:{title:"dBDt",description:"GQpQ"},required:!0,type:"decimal",validator:validators.zeroToOneInc}}},{name:"frequency",fn:Array.prototype.frequency,filter:null,wiki:{title:"dYJK",description:"Tzyp"},type:[1,2,3],returns:schemas.frequencyTable,example:function(){new NumericVector(5,2,3,2,3,3,1,6,3).frequency(),new StringVector("E","B","C","B","C","C","A","F","C").frequency(3),new BooleanVector(!0,!1,null,!0,null,null).frequency(4)},args:{order:{wiki:{title:"gZCx"},required:!1,default:1,type:"enum",validator:validators.enumValidator(schemas.frequencyOrderEnum)}}},{name:"geomean",fn:Array.prototype.geomean,filter:filters.number,wiki:{title:"louK",description:"PDzr"},type:[1],returns:schemas.number,example:function(){new framework.NumericVector(20,19,21,22,21,18,23,22,27,16,17,19,19,21,29,24,23,25,24,21,22,19).geomean()}},{name:"harmean",fn:Array.prototype.harmean,filter:filters.number,wiki:{title:"vpdN",description:"nhJv"},type:[1],returns:schemas.number,example:function(){new framework.NumericVector(20,19,21,22,21,18,23,22,27,16,17,19,19,21,29,24,23,25,24,21,22,19).harmean()}},{name:"median",fn:Array.prototype.median,filter:filters.number,wiki:{title:"TzfX",description:"YIir"},type:[1],returns:schemas.number,example:function(){new NumericVector(20,19,21,22,21,18,23,22,27,16,17,19,19,21,29,24,23,25,24,21,22,19).median()}},{name:"mode",fn:Array.prototype.mode,wiki:{title:"StQx",description:"IBfx"},type:[1,2,3],returns:schemas.any,example:function(){new NumericVector(1,2,3,4,3,4,5,3).mode(),new StringVector("a",null,null,"b","c","d",null,"b").mode(),new BooleanVector(!0,!1,!0).mode()}},{name:"SEM",fn:Array.prototype.SEM,filter:filters.number,wiki:{title:"dLmV",description:"ZBnI"},type:[1],returns:schemas.number,example:function(){new NumericVector(20,19,21,22,21,18,23,22,27,16,17,19,19,21,29,24,23,25,24,21,22,19).SEM()}},{name:"skewness",fn:Array.prototype.skewness,filter:filters.number,wiki:{title:"KZgI",description:""},type:[1],returns:schemas.number,example:function(){new NumericVector(20,19,21,22,21,18,23,22,27,16,17,19,19,21,29,24,23,25,24,21,22,19).skewness(!1),new NumericVector(20,19,21,22,21,18,23,22,27,16,17,19,19,21,29,24,23,25,24,21,22,19).skewness(!0)},args:{s:{wiki:{title:"eJTq",description:"FfpU"},required:!1,default:!1,type:"boolean",validator:validators.boolean}}},{name:"kurtosis",fn:Array.prototype.kurtosis,filter:filters.number,wiki:{title:"oPPx",description:"UOBG"},type:[1],returns:schemas.number,example:function(){new NumericVector(20,19,21,22,21,18,23,22,27,16,17,19,19,21,29,24,23,25,24,21,22,19).kurtosis()}},{name:"ttest",fn:Array.prototype.ttest,filter:filters.number,wiki:{title:"VEAt",description:"rbjM"},type:[1],returns:schemas.number,example:function(){var e=new NumericVector(10,20,15,25,23,19,18,17,24,23);e.percentile(.5),e.percentile(.25),e.percentile(1)},args:{populationMean:{wiki:{title:"GRoZ",description:"xtfz"},required:!0,type:"number",validator:validators.number}}}].sort(((e,r)=>e.name>r.name));class VectorMethod{constructor(e,r){if(r&&(this.parent=r),"string"==typeof e){if(!VectorMethodsModels[e])throw new Error("Model not found: "+e);this.model=Models.vector[e]}else{if("object"!=typeof e)throw new Error("Unknown VectorMethod constructor parameter type.");this.model=e}}get name(){return this.model.name}get fn(){return this.model.fn}get filter(){return this.model.filter?this.model.filter.fn:()=>!0}get wiki(){return this.model.wiki?{name:this.model.name,title:$(this.model.wiki.title),description:$(this.model.wiki.description),filter:this.model.filter?$(this.model.filter.text):null,applies:[{type:1,title:$("LOYN"),apply:this.model.type.indexOf(1)>-1},{type:2,title:$("zoiB"),apply:this.model.type.indexOf(2)>-1},{type:3,title:$("OkoC"),apply:this.model.type.indexOf(3)>-1}],returns:this.model.returns,example:this.model.example?this.model.example.stringify():null,arguments:function(e){var r=[];if(!e)return[];for(let t of Object.keys(e))r.push({name:t,title:e[t].wiki?.title?$(e[t].wiki.title):null,validator:e[t].validator?.text?$(e[t].validator?.text):null,description:e[t]?.wiki?.description?$(e[t].wiki.description):null,required:!!e[t]?.required,default:e[t].default||null,multiple:!!e[t].multiple});return r}(this.model.args)}:{}}markdown(e=1){return VectorMarkdown(this.wiki,e)}call(){if(!this.parent)return new Empty($("hKRq"));if(-1===this.model.type.indexOf(this.parent?.type()))return new Empty($("ibNu",{method:$(this.model.wiki.title),type:$(getVectorTypeLabelCode(this.parent))}));var e=this.validate(...arguments),r=this.filter?this.parent.filter(this.filter):this.parent;return this.fn.call(r,...e)}with(e){return this.parent=e,this}validate(){if(!this.parent)return new Empty($("hKRq"));var e=0,r=Array.prototype.slice.call(arguments),t=[];if(0===(this.model.args||[]).length)return r;for(let n of Object.keys(this.model.args)){var i=this.model.args[n]?.validator?.fn||function(e){return e};if(r[e]||0===r[e]||!1===r[e])try{t.push(i(r[e]))}catch(e){throw new ArgumentError(e,this)}else{if(this.model.args[n]?.required)throw new ArgumentError($("dSWt",{name:n,title:$(this.model.args[n].wiki?.title),method:$(this.model.wiki?.title)}),this);t.push(this.model.args[n].default)}e++}return t}}function getVectorTypeLabelCode(e){switch(e.type()){case 1:return"kPSW";break;case 2:return"UQoV";break;case 3:return"WiEE";break;case 4:return"LiPr";break;case 5:return"sbFB";break;default:return null}}VectorMethodsModels.forEach((function(e){Vector.prototype[e.name]=function(){var r=new VectorMethod(e,this);return r.call(...arguments)}}));const Models={};VectorMethodsModels.map((function(e){Models[e.name]=new VectorMethod(e)})),module.exports={$:$,NumericVector:NumericVector,StringVector:StringVector,BooleanVector:BooleanVector,VectorMethod:VectorMethod,Models:Models,VectorOverview:VectorOverview(Models)};